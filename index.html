<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø£ÙØ±Ø§Ø­ Ø§Ù„Ù…Ø­Ø§ÙŠØ§</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Kufi+Arabic:wght@400;600;800&family=Alexandria:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --gold: #d4a853;
            --gold-dark: #b8923a;
            --navy: #0a1628;
            --navy-light: #152238;
            --white: #ffffff;
            --red: #ff4d4d;
            --radius-lg: 20px;
            --overlay: rgba(0, 0, 0, 0.85);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Noto Kufi Arabic', sans-serif;
            background-color: var(--navy);
            margin: 0; color: var(--white); line-height: 1.6;
            overflow-x: hidden; min-height: 100vh;
        }

        /* === Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„Ø²Ø®Ø§Ø±Ù === */
        .bg-pattern { position: fixed; inset: 0; pointer-events: none; z-index: 0; }
        .bg-pattern::before {
            content: ''; position: absolute; top: -50%; right: -50%; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(212, 168, 83, 0.08) 0%, transparent 50%);
            animation: floatBg 25s infinite linear;
        }
        @keyframes floatBg { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .main-container { position: relative; z-index: 1; max-width: 1000px; margin: 0 auto; padding: 15px; }

        /* === Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„ÙØ§Ø®Ø± === */
        header { text-align: center; padding: 40px 0; }
        .logo-wrapper { position: relative; width: 160px; height: 160px; margin: 0 auto 25px; }
        .logo-ring { position: absolute; inset: 0; border: 2px solid var(--gold); border-top-color: transparent; border-radius: 50%; animation: logoSpin 4s linear infinite; }
        .logo-ring:nth-child(2) { inset: 12px; border: 1.5px solid var(--white); border-bottom-color: transparent; animation-direction: reverse; animation-duration: 6s; opacity: 0.5; }
        
        .logo-icon { 
            position: absolute; inset: 10px; background: radial-gradient(circle, var(--navy-light), var(--navy)); 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            box-shadow: 0 0 50px rgba(212, 168, 83, 0.3); overflow: hidden;
        }
        .logo-icon img { width: 85%; height: auto; object-fit: contain; }

        @keyframes logoSpin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        header h1 { font-family: 'Alexandria'; font-size: 1.9rem; background: linear-gradient(180deg, #fff 30%, var(--gold) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); }

        /* Ø§Ù„Ø¨Ø­Ø« */
        .search-container { max-width: 600px; margin: 0 auto 30px; }
        .search-input { width: 100%; padding: 16px; background: rgba(255,255,255,0.03); border: 1px solid rgba(212,168,83,0.3); border-radius: 50px; color: white; text-align: center; outline: none; transition: 0.4s; backdrop-filter: blur(5px); }
        .search-input:focus { border-color: var(--gold); box-shadow: 0 0 20px rgba(212,168,83,0.2); background: rgba(255,255,255,0.06); }

        /* Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
        .table-container { background: rgba(21, 34, 56, 0.4); border-radius: var(--radius-lg); border: 1px solid rgba(212,168,83,0.1); overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.6); backdrop-filter: blur(10px); }
        table { width: 100%; border-collapse: collapse; }
        thead th { background: rgba(212, 168, 83, 0.1); color: var(--gold); padding: 20px 10px; border-bottom: 2px solid var(--gold); font-family: 'Alexandria'; font-size: 0.85rem; letter-spacing: 1px; }
        td { padding: 20px 10px; text-align: center; border-bottom: 1px solid rgba(212,168,83,0.05); }

        .day-label { color: var(--gold); font-weight: 800; font-size: 1rem; display: block; margin-bottom: 2px; }
        .date-label { color: var(--white); font-size: 0.8rem; opacity: 0.6; display: block; }
        .groom-name { font-weight: 700; font-size: 1.15rem; color: #fff; display: block; margin-bottom: 6px; }
        .hall-info { color: #999; font-size: 0.85rem; }
        .location-intl { color: var(--gold) !important; font-weight: 800; }

        /* Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
        .admin-controls { display: flex; justify-content: center; gap: 10px; }
        .ctrl-btn { background: rgba(212,168,83,0.1); border: 1px solid rgba(212,168,83,0.2); border-radius: 10px; color: var(--gold); padding: 10px; cursor: pointer; transition: 0.3s; }
        .ctrl-btn:hover { background: var(--gold); color: var(--navy); transform: translateY(-2px); }

        /* === Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„ÙØ§Ø®Ø±Ø© (Professional Modals) === */
        .modal-overlay { position: fixed; inset: 0; background: var(--overlay); display: none; justify-content: center; align-items: center; z-index: 9999; backdrop-filter: blur(20px); animation: fadeIn 0.4s ease; }
        .modal-card { background: linear-gradient(145deg, var(--navy-light), var(--navy)); border: 1px solid rgba(212,168,83,0.4); border-radius: 30px; padding: 40px; width: 95%; max-width: 450px; text-align: center; box-shadow: 0 30px 70px rgba(0,0,0,0.8); position: relative; overflow: hidden; transform: scale(0.9); transition: 0.4s; }
        .modal-overlay[style*="display: flex"] .modal-card { transform: scale(1); }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .modal-card h3 { color: var(--gold); font-family: 'Alexandria'; font-size: 1.4rem; margin-bottom: 25px; }
        .modal-card input, .modal-card select { background: rgba(255,255,255,0.03); border: 1px solid rgba(212,168,83,0.2); border-radius: 15px; color: white; padding: 15px; width: 100%; margin-bottom: 15px; outline: none; transition: 0.3s; }
        .modal-card input:focus { border-color: var(--gold); background: rgba(255,255,255,0.07); }

        .btn-group { display: flex; gap: 15px; margin-top: 15px; }
        .btn-main { flex: 1; padding: 16px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; transition: 0.4s; font-family: 'Alexandria'; font-size: 0.9rem; }
        .btn-gold { background: linear-gradient(135deg, var(--gold), var(--gold-dark)); color: var(--navy); box-shadow: 0 10px 20px rgba(212,168,83,0.2); }
        .btn-gold:hover { transform: translateY(-3px); box-shadow: 0 15px 25px rgba(212,168,83,0.3); }
        .btn-cancel { background: rgba(255,255,255,0.05); color: #bbb; border: 1px solid rgba(255,255,255,0.1); }
        .btn-cancel:hover { background: rgba(255,255,255,0.1); color: #fff; }

        /* === Ø²Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ === */
        .logout-btn { 
            background: linear-gradient(135deg, #444, #222); color: #ff4d4d; border: 1px solid rgba(255,77,77,0.3); 
            padding: 12px 25px; border-radius: 50px; cursor: pointer; transition: 0.3s; 
            display: inline-flex; align-items: center; gap: 10px; font-weight: bold; font-family: 'Alexandria';
            margin-top: 30px; font-size: 0.85rem;
        }
        .logout-btn:hover { background: var(--red); color: white; box-shadow: 0 10px 20px rgba(255,77,77,0.2); transform: translateY(-2px); }

        footer { text-align: center; padding: 60px 15px; margin-top: 40px; border-top: 1px solid rgba(212,168,83,0.1); }
        .blessing { font-family: 'Amiri'; font-size: 1.3rem; color: var(--gold); margin-bottom: 15px; }
        .sponsor-box { user-select: none; }
        .sponsor-main { font-weight: 800; font-size: 1.2rem; display: block; margin-bottom: 5px; opacity: 0.8; }
        .sponsor-sub { color: var(--gold); font-size: 0.9rem; font-weight: 600; }
    </style>
</head>
<body>

<div class="bg-pattern"></div>

<div class="main-container">
    <header>
        <div class="logo-wrapper">
            <div class="logo-ring"></div>
            <div class="logo-ring"></div>
            <div class="logo-icon"><img src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØµØ©"></div>
        </div>
        <h1>Ø£ÙØ±Ø§Ø­ Ù‚Ø¨ÙŠÙ„Ø© Ø§Ù„Ù…Ø­Ø§ÙŠØ§</h1>
    </header>

    <div class="search-container">
        <input type="text" id="searchInput" onkeyup="search()" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙŠØ³ØŒ Ø§Ù„Ù‚Ø§Ø¹Ø©ØŒ Ø£Ùˆ Ø§Ù„ØªØ§Ø±ÙŠØ®...">
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th width="120px">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</th>
                    <th id="adminHeader" style="display:none;" width="115px">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody id="eventTable"></tbody>
        </table>
    </div>

    <div id="adminArea" style="display:none; text-align:center;">
        <button class="btn-main btn-gold" style="width:auto; padding: 16px 50px; margin-top: 40px;" onclick="openModal()">
            <i class="fa-solid fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©
        </button>
        <br>
        <button class="logout-btn" onclick="logout()">
            <i class="fa-solid fa-power-off"></i> ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        </button>
    </div>

    <footer>
        <div class="blessing">" Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù„Ù‡ Ù„Ù‡Ù…Ø§ ÙˆØ¨Ø§Ø±Ùƒ Ø¹Ù„ÙŠÙ‡Ù…Ø§ ÙˆØ¬Ù…Ø¹ Ø¨ÙŠÙ†Ù‡Ù…Ø§ Ø¨Ø®ÙŠØ± "</div>
        <div class="sponsor-box">
            <span id="secretTrigger" class="sponsor-main">Ù…Ù†ØµØ© Ù‚Ø¨ÙŠÙ„Ø© Ø§Ù„Ù…Ø­Ø§ÙŠØ§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠØ©</span>
            <span class="sponsor-sub">Ø¨Ø±Ø¹Ø§ÙŠØ© Ø±Ø¬Ù„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ / Ø¹ÙŠØ¯ Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ù…Ø­ÙŠØ§Ù†ÙŠ</span>
        </div>
    </footer>
</div>

<div id="loginModal" class="modal-overlay">
    <div class="modal-card">
        <h3><i class="fa-solid fa-shield-halved" style="margin-left: 10px;"></i> Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
        <input type="password" id="passInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø³Ø±ÙŠØ©">
        <div class="btn-group">
            <button class="btn-main btn-gold" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
            <button class="btn-main btn-cancel" onclick="closeM('loginModal')">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>
</div>

<div id="eventModal" class="modal-overlay">
    <div class="modal-card">
        <h3 id="modalTitle">Ø¥Ø¯Ø§Ø±Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</h3>
        <input type="hidden" id="editIdx">
        <div style="display:flex; gap:10px;">
            <select id="inDayName">
                <option value="">Ø§Ù„ÙŠÙˆÙ…</option><option>Ø§Ù„Ø³Ø¨Øª</option><option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option><option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option><option>Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
            </select>
            <input type="number" id="inDayNum" placeholder="ÙŠÙˆÙ…">
            <input type="number" id="inMonthNum" placeholder="Ø´Ù‡Ø±">
            <input type="number" id="inYearNum" placeholder="Ø³Ù†Ø©">
        </div>
        <input type="text" id="inName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙŠØ³ Ø§Ù„ÙƒØ§Ù…Ù„">
        <input type="text" id="inHall" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø¹Ø© ÙˆØ§Ù„Ù…Ø¯ÙŠÙ†Ø©">
        <select id="inCountry">
            <option value="">Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
            <option value="Ø§Ù„ÙƒÙˆÙŠØª">Ø¯ÙˆÙ„Ø© Ø§Ù„ÙƒÙˆÙŠØª ğŸ‡°ğŸ‡¼</option>
        </select>
        <div class="btn-group">
            <button class="btn-main btn-gold" onclick="save()">ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <button class="btn-main btn-cancel" onclick="closeM('eventModal')">ØªØ±Ø§Ø¬Ø¹</button>
        </div>
    </div>
</div>

<div id="deleteModal" class="modal-overlay">
    <div class="modal-card">
        <h3 style="color: var(--red);"><i class="fa-solid fa-triangle-exclamation"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h3>
        <p style="margin-bottom: 25px; opacity: 0.8;">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù…Ù† Ø§Ù„Ù…Ù†ØµØ©ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.</p>
        <input type="hidden" id="deleteIdx">
        <div class="btn-group">
            <button class="btn-main btn-gold" style="background: var(--red); color: white;" onclick="confirmDel()">Ù†Ø¹Ù…ØŒ Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</button>
            <button class="btn-main btn-cancel" onclick="closeM('deleteModal')">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>
</div>

<script>
    let isAdmin = false;
    const sKey = "mahaya_pro_v10";

    const rawData = [
        {d: "Ø§Ù„Ø³Ø¨Øª\n28 / 07 / 1447 Ù‡Ù€", n: "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø²ÙˆÙŠØ¯ Ø¨Ù† Ù…Ù†Ø§Ø­ÙŠ Ø¨Ù† Ù†Ø§ÙÙ„ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø¨Ø±ÙˆØ§Ø² - Ø§Ù„Ø¸Ù‡Ø±Ø§Ù†", c: ""},
        {d: "Ø§Ù„Ø£Ø­Ø¯\n03 / 10 / 1447 Ù‡Ù€", n: "Ø®Ø§Ù„Ø¯ Ø¨Ù† Ù‚Ø¹ÙŠØ¯ Ø¨Ù† Ù…Ù‚Ø¹Ø¯ Ø£Ø¨Ùˆ ÙƒØªÙŠÙÙ‡", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡\n05 / 10 / 1447 Ù‡Ù€", n: "Ø£Ø­Ù…Ø¯ Ø¨Ù† Ù‚Ø§Ø¹ÙØ¯ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø¯Ø±Ù‡Ù… Ø§Ø¨ÙˆÙƒØªÙŠÙØ©", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ØµÙÙˆØ© - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n14 / 10 / 1447 Ù‡Ù€", n: "Ø³Ø§Ù„Ù… Ø¨Ù† Ø·Ù„Ù‚ Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø¨Ù† Ø¨Ø¬Ø§Ø¯ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù† - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n15 / 10 / 1447 Ù‡Ù€", n: "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø¨Ù† Ø¹Ù„ÙŠ Ø¨Ù† Ù…Ø²ÙŠØ¯ Ø¨Ù† ÙƒÙ„ÙŠØ¨ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n22 / 10 / 1447 Ù‡Ù€", n: "ÙÙŠØµÙ„ Ø¨Ù† Ù†ÙˆØ§Ø± Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†ÙˆÙŠØµØ­ Ø¨Ù† Ù‡Ø¶Ù„Ø§ Ø§Ù„Ø´Ø¨ÙŠØ«Ø§Ù†ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø³ÙØ§Ø±Ø§Øª - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n14 / 11 / 1447 Ù‡Ù€", n: "ØªØ±ÙƒÙŠ Ø¨Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø³Ø¹ÙˆØ¯ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n20 / 11 / 1447 Ù‡Ù€", n: "Ø¨Ø§Ù†ÙŠ Ø¨Ù† Ø¶ÙŠÙ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø¹Ø§ÙŠØ¶ Ø§Ø¨ÙˆÙƒØªÙŠÙÙ‡", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n20 / 11 / 1447 Ù‡Ù€", n: "Ø±ÙŠØ§Ù† Ø¨Ù† Ù…Ø´Ø¹Ù„ Ø¨Ù† Ù…Ø³Ø­Ù„ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø£ØµØ§ÙŠÙ„ - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n21 / 11 / 1447 Ù‡Ù€", n: "Ø®Ø§Ù„Ø¯ Ø¨Ù† Ø´Ø¨ÙŠØ¨ Ø¨Ù† Ø¸Ø§ÙØ± Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n28 / 11 / 1447 Ù‡Ù€", n: "Ù…Ø¨Ø§Ø±Ùƒ Ø¨Ù† Ù…Ø¯Ø±Ù‡Ù… Ø£Ø¨Ùˆ ÙƒØªÙŠÙÙ‡", h: "Ø¯ÙˆÙ„Ø© Ø§Ù„ÙƒÙˆÙŠØª", c: "Ø§Ù„ÙƒÙˆÙŠØª"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n19 / 12 / 1447 Ù‡Ù€", n: "Ø¹Ù„ÙŠ Ø¨Ù† Ù…Ø·Ù„Ù‚ Ø¨Ù† Ø¹ÙˆØ¶ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ÙØ®Ø§Ù…Ø© - Ø´Ù‚Ø±Ø§Ø¡", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n24 / 01 / 1448 Ù‡Ù€", n: "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø±Ø²ÙˆÙ‚ Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ø¬Ø±", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø© - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n10 / 02 / 1448 Ù‡Ù€", n: "Ø¹Ø§Ø¯Ù„ Ø¨Ù† Ø³Ù„ÙŠÙ…Ø§Ù† Ø¨Ù† Ù…Ù‚Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ÙØ®Ø§Ù…Ø© - Ø´Ù‚Ø±Ø§Ø¡", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n21 / 03 / 1448 Ù‡Ù€", n: "Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø¨Ù† ÙƒÙ„ÙŠØ¨ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n21 / 04 / 1448 Ù‡Ù€", n: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ± Ø¨Ù† ÙÙ„Ø§Ø­ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""}
    ];

    function getSortVal(dStr) {
        const m = dStr.match(/(\d{2}) \/ (\d{2}) \/ (\d{4})/);
        return m ? parseInt(m[3] + m[2] + m[1]) : 0;
    }

    function draw() {
        const body = document.getElementById('eventTable'); body.innerHTML = '';
        let list = JSON.parse(localStorage.getItem(sKey)) || rawData;
        list.sort((a, b) => getSortVal(a.d) - getSortVal(b.d));
        
        document.getElementById('adminHeader').style.display = isAdmin ? 'table-cell' : 'none';
        document.getElementById('adminArea').style.display = isAdmin ? 'block' : 'none';

        list.forEach((ev, i) => {
            const tr = document.createElement('tr');
            const parts = ev.d.split('\n');
            tr.innerHTML = `
                <td><span class="day-label">${parts[0]}</span><span class="date-label">${parts[1]}</span></td>
                <td style="text-align:right">
                    <span class="groom-name">${ev.n}</span>
                    <span class="hall-info ${ev.c === 'Ø§Ù„ÙƒÙˆÙŠØª' ? 'location-intl' : ''}">${ev.c === 'Ø§Ù„ÙƒÙˆÙŠØª' ? 'ğŸ‡°ğŸ‡¼ ' : ''}${ev.h}</span>
                </td>
                ${isAdmin ? `<td>
                    <div class="admin-controls">
                        <button class="ctrl-btn" onclick="openModal(${i})"><i class="fa-solid fa-edit"></i></button>
                        <button class="ctrl-btn" style="color:var(--red)" onclick="askDel(${i})"><i class="fa-solid fa-trash"></i></button>
                    </div>
                </td>` : ''}
            `;
            body.appendChild(tr);
        });
    }

    // Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠ
    const secretTrigger = document.getElementById('secretTrigger');
    let pressTimer;
    secretTrigger.addEventListener('mousedown', () => pressTimer = setTimeout(() => document.getElementById('loginModal').style.display='flex', 1500));
    secretTrigger.addEventListener('touchstart', () => pressTimer = setTimeout(() => document.getElementById('loginModal').style.display='flex', 1500));
    secretTrigger.addEventListener('mouseup', () => clearTimeout(pressTimer));
    secretTrigger.addEventListener('touchend', () => clearTimeout(pressTimer));

    function login() {
        if(document.getElementById('passInput').value === "99511511") {
            isAdmin = true; closeM('loginModal'); draw();
        } else { alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©."); }
    }

    function logout() { isAdmin = false; draw(); }
    function closeM(id) { document.getElementById(id).style.display = 'none'; }

    function openModal(idx = -1) {
        document.getElementById('editIdx').value = idx;
        if(idx === -1) {
            document.getElementById('modalTitle').innerText = "Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©";
            document.getElementById('inName').value = ''; document.getElementById('inHall').value = '';
            document.getElementById('inDayNum').value = ''; document.getElementById('inMonthNum').value = ''; document.getElementById('inYearNum').value = '';
        } else {
            document.getElementById('modalTitle').innerText = "ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©";
            let list = JSON.parse(localStorage.getItem(sKey)) || rawData;
            const e = list[idx]; const p = e.d.split('\n');
            document.getElementById('inDayName').value = p[0];
            const m = p[1].match(/(\d{2}) \/ (\d{2}) \/ (\d{4})/);
            if(m) {
                document.getElementById('inDayNum').value = parseInt(m[1]);
                document.getElementById('inMonthNum').value = parseInt(m[2]);
                document.getElementById('inYearNum').value = parseInt(m[3]);
            }
            document.getElementById('inName').value = e.n; document.getElementById('inHall').value = e.h;
            document.getElementById('inCountry').value = e.c || '';
        }
        document.getElementById('eventModal').style.display = 'flex';
    }

    function save() {
        let list = JSON.parse(localStorage.getItem(sKey)) || rawData;
        const idx = parseInt(document.getElementById('editIdx').value);
        const day = document.getElementById('inDayName').value;
        const d = document.getElementById('inDayNum').value.padStart(2, '0');
        const m = document.getElementById('inMonthNum').value.padStart(2, '0');
        const y = document.getElementById('inYearNum').value;
        const fDate = `${day}\n${d} / ${m} / ${y} Ù‡Ù€`;
        const obj = { d: fDate, n: document.getElementById('inName').value, h: document.getElementById('inHall').value, c: document.getElementById('inCountry').value };
        if(idx === -1) list.push(obj); else list[idx] = obj;
        localStorage.setItem(sKey, JSON.stringify(list)); closeM('eventModal'); draw();
    }

    function askDel(idx) { document.getElementById('deleteIdx').value = idx; document.getElementById('deleteModal').style.display = 'flex'; }
    function confirmDel() {
        let list = JSON.parse(localStorage.getItem(sKey)) || rawData;
        list.splice(document.getElementById('deleteIdx').value, 1);
        localStorage.setItem(sKey, JSON.stringify(list)); closeM('deleteModal'); draw();
    }

    function search() {
        let v = document.getElementById('searchInput').value.toUpperCase();
        let rows = document.getElementById('eventTable').getElementsByTagName('tr');
        for (let r of rows) { r.style.display = r.innerText.toUpperCase().includes(v) ? "" : "none"; }
    }

    window.onload = draw;
</script>
</body>
</html>
