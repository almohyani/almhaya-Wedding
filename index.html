<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ù†ØµØ© Ø£ÙØ±Ø§Ø­ Ø§Ù„Ù…Ø­Ø§ÙŠØ§</title>
    <link href="https://fonts.googleapis.com/css2?family=Alexandria:wght@400;700&family=Almarai:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --deep-navy: #0a192f;
            --luxury-gold: #c5a059;
            --white: #ffffff;
            --bg-gray: #f2f5f8;
            --overlay: rgba(0, 0, 0, 0.75);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Almarai', sans-serif;
            background-color: var(--bg-gray);
            margin: 0;
            padding: 10px;
            color: #222;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 10px auto;
            background: var(--white);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid rgba(197, 160, 89, 0.2);
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„Ù…Ø®Ø·ÙˆØ·Ø© */
        .header {
            background-color: var(--deep-navy);
            padding: 35px 15px;
            text-align: center;
            border-bottom: 5px solid var(--luxury-gold);
        }

        .header img {
            max-width: 220px;
            height: auto;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.4));
        }
        .header-text {
    font-family: 'Alexandria', sans-serif; /* Ù†ÙØ³ Ø§Ù„Ø®Ø· Ø§Ù„Ø¨Ø±ÙˆÙÙŠØ´Ù†Ø§Ù„ Ø§Ù„Ø°ÙŠ Ø§Ø®ØªØ±Ù†Ø§Ù‡ */
    color: var(--white); /* Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø¨ÙŠØ¶ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„ÙƒØ­Ù„ÙŠØ© */
    font-size: 1.8rem; /* Ø­Ø¬Ù… Ø®Ø· Ù…ØªÙ†Ø§Ø³Ø¨ */
    margin-top: 15px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø© ÙˆØ§Ù„Ù†Øµ */
    font-weight: 700; /* Ø¬Ø¹Ù„ Ø§Ù„Ø®Ø· Ø¹Ø±ÙŠØ¶Ø§Ù‹ ÙˆØ¨Ø§Ø±Ø²Ø§Ù‹ */
    text-shadow: 0 2px 4px rgba(0,0,0,0.3); /* Ø¸Ù„ Ø®ÙÙŠÙ Ù„Ø¥Ø¨Ø±Ø§Ø² Ø§Ù„Ù†Øµ */
}

/* ØªØ¹Ø¯ÙŠÙ„ Ù„Ù„Ù‡ÙˆØ§ØªÙ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙ†Ø§Ø³Ù‚ */
@media (max-width: 600px) {
    .header-text {
        font-size: 1.4rem; /* ØªØµØºÙŠØ± Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ */
    }
}


        /* Ø§Ù„Ø¨Ø­Ø« */
        .search-section { padding: 25px 15px; text-align: center; background: #fff; }
        .search-section input {
            width: 100%;
            max-width: 500px;
            padding: 14px 20px;
            border-radius: 30px;
            border: 2px solid #eef1f4;
            font-family: 'Almarai';
            font-size: 1rem;
            outline: none;
            transition: 0.3s;
            box-shadow: 0 3px 10px rgba(0,0,0,0.02);
        }
        .search-section input:focus { border-color: var(--luxury-gold); }

        /* Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨ */
        .table-container { padding: 0 15px 30px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        thead th {
            font-family: 'Alexandria';
            padding: 15px 10px;
            color: var(--deep-navy);
            border-bottom: 2px solid var(--luxury-gold);
            font-weight: 700;
        }
        tbody tr { border-bottom: 1px solid #f1f1f1; transition: 0.2s; }
        tbody tr:hover { background-color: #fdfaf4; }
        tbody td { padding: 18px 10px; text-align: center; vertical-align: middle; }
        
        .col-date { font-weight: 700; color: var(--deep-navy); font-size: 0.95rem; white-space: pre-line; }
        .col-groom { font-weight: 700; color: #333; font-size: 1rem; }
        .col-hall { color: #666; font-size: 0.9rem; }

        /* Ø§Ù„ØªØ°ÙŠÙŠÙ„ */
        .footer { padding: 40px 15px; text-align: center; border-top: 1px solid #eee; }
        .blessing { font-family: 'Alexandria'; font-size: 1.4rem; color: var(--deep-navy); margin-bottom: 30px; font-weight: 700; }
        .branding-info { border-top: 1px solid #ddd; padding-top: 25px; display: inline-block; width: 90%; }
        .platform-txt { font-weight: 700; font-size: 1.3rem; color: var(--deep-navy); }
        .sponsor-txt { color: var(--luxury-gold); font-size: 1.1rem; margin-top: 5px; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn { border: none; border-radius: 50px; cursor: pointer; font-family: 'Almarai'; font-weight: 700; transition: 0.3s; padding: 12px 25px; }
        .btn-gold { background: var(--luxury-gold); color: white; }
        .btn-navy { background: var(--deep-navy); color: white; }
        .btn-gray { background: #eee; color: #555; }
        .admin-trigger { background: none; border: none; color: #bbb; font-size: 0.75rem; margin-top: 40px; cursor: pointer; }

        /* Modals (Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©) */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--overlay);
            display: none; justify-content: center; align-items: center;
            z-index: 9999; backdrop-filter: blur(8px); padding: 10px;
        }
        .modal-card {
            background: white; border-radius: 20px; width: 100%; max-width: 450px;
            padding: 30px; border-top: 8px solid var(--luxury-gold);
            animation: modalFade 0.3s ease-out;
        }
        @keyframes modalFade { from {opacity: 0; transform: translateY(-20px);} to {opacity: 1; transform: translateY(0);} }
        .modal-card h3 { font-family: 'Alexandria'; text-align: center; margin-bottom: 25px; color: var(--deep-navy); }
        .modal-card input {
            width: 100%; padding: 14px; margin-bottom: 15px;
            border: 2px solid #f0f0f0; border-radius: 12px; font-family: 'Almarai';
        }
        .modal-btns { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }

        @media (max-width: 600px) {
            .header img { max-width: 160px; }
            .blessing { font-size: 1.1rem; }
            .platform-txt { font-size: 1.1rem; }
            tbody td { padding: 15px 8px; font-size: 0.85rem; }
        }
    </style>
</head>
<body>

<div class="header">
    <img src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø­ÙŠØ§Ù†ÙŠ" class="logo-image">
    
    <h1 class="header-text">Ø£ÙØ±Ø§Ø­ Ù‚Ø¨ÙŠÙ„Ø© Ø§Ù„Ù…Ø­Ø§ÙŠØ§</h1>
</div>

    <div class="search-section">
        <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø£Ùˆ Ù‚Ø§Ø¹Ø© Ø£Ùˆ ØªØ§Ø±ÙŠØ®...">
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th width="25%">Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th width="45%">Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙŠØ³</th>
                    <th width="30%">Ø§Ù„Ù…ÙˆÙ‚Ø¹ / Ø§Ù„Ù‚Ø§Ø¹Ø©</th>
                    <th id="adminHeader" style="display:none;">ØªØ­ÙƒÙ…</th>
                </tr>
            </thead>
            <tbody id="mainTableBody"></tbody>
        </table>
    </div>

    <div class="footer">
        <div class="blessing">" Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù„Ù‡ Ù„Ù‡Ù…Ø§ ÙˆØ¨Ø§Ø±Ùƒ Ø¹Ù„ÙŠÙ‡Ù…Ø§ ÙˆØ¬Ù…Ø¹ Ø¨ÙŠÙ†Ù‡Ù…Ø§ Ø¨Ø®ÙŠØ± "</div>
        <div class="branding-info">
            <div class="platform-txt">Ù…Ù†ØµØ© Ù‚Ø¨ÙŠÙ„Ø© Ø§Ù„Ù…Ø­Ø§ÙŠØ§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠØ©</div>
            <div class="sponsor-txt">Ø¨Ø±Ø¹Ø§ÙŠØ© Ø±Ø¬Ù„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ / Ø¹ÙŠØ¯ Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ù…Ø­ÙŠØ§Ù†ÙŠ</div>
        </div>
        
        <div id="adminArea" style="display:none; margin-top:25px;">
            <button class="btn btn-gold" onclick="openEditModal()">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
            <br><button class="admin-trigger" onclick="logout()" style="color:#e74c3c;">Ø®Ø±ÙˆØ¬</button>
        </div>
        <button id="loginBtn" class="admin-trigger" onclick="openLoginModal()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
    </div>
</div>

<div id="loginModal" class="modal-overlay">
    <div class="modal-card">
        <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
        <input type="password" id="adminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="text-align:center;">
        <div class="modal-btns">
            <button class="btn btn-gray" onclick="closeModal('loginModal')">Ø¥Ù„ØºØ§Ø¡</button>
            <button class="btn btn-navy" onclick="doLogin()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>
</div>

<div id="eventModal" class="modal-overlay">
    <div class="modal-card">
        <h3 id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø©</h3>
        <input type="hidden" id="editIdx" value="-1">
        <input type="text" id="inDate" placeholder="Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø³Ø¨Øª 1447/07/28)">
        <input type="text" id="inName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙŠØ³">
        <input type="text" id="inHall" placeholder="Ø§Ù„Ù‚Ø§Ø¹Ø© ÙˆØ§Ù„Ù…Ø¯ÙŠÙ†Ø©">
        <div class="modal-btns">
            <button class="btn btn-gray" onclick="closeModal('eventModal')">Ø¥Ù„ØºØ§Ø¡</button>
            <button class="btn btn-gold" onclick="saveEvent()">Ø­ÙØ¸ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</button>
        </div>
    </div>
</div>

<div id="msgModal" class="modal-overlay">
    <div class="modal-card" style="text-align:center;">
        <h3 id="msgTitle">ØªÙ†Ø¨ÙŠÙ‡</h3>
        <p id="msgBody" style="margin-bottom:20px; color:#555;"></p>
        <button class="btn btn-navy" onclick="closeModal('msgModal')">Ù…ÙˆØ§ÙÙ‚</button>
    </div>
</div>

<div id="confirmModal" class="modal-overlay">
    <div class="modal-card" style="text-align:center;">
        <h3 style="color:#e74c3c;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h3>
        <p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ</p>
        <input type="hidden" id="delIdx">
        <div class="modal-btns">
            <button class="btn btn-gray" onclick="closeModal('confirmModal')">ØªØ±Ø§Ø¬Ø¹</button>
            <button class="btn btn-navy" style="background:#e74c3c;" onclick="doDelete()">Ù†Ø¹Ù…ØŒ Ø­Ø°Ù</button>
        </div>
    </div>
</div>

<script>
    let isAdminActive = false;
    const tribalData = [
        {d: "Ø§Ù„Ø³Ø¨Øª\n28 / 07 / 1447 Ù‡Ù€", n: "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø²ÙˆÙŠØ¯ Ø¨Ù† Ù…Ù†Ø§Ø­ÙŠ Ø¨Ù† Ù†Ø§ÙÙ„ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø¨Ø±ÙˆØ§Ø²\nØ§Ù„Ø¸Ù‡Ø±Ø§Ù†"},
        {d: "Ø§Ù„Ø£Ø­Ø¯\n03 / 10 / 1447 Ù‡Ù€", n: "Ø®Ø§Ù„Ø¯ Ø¨Ù† Ù‚Ø¹ÙŠØ¯ Ø¨Ù† Ù…Ù‚Ø¹Ø¯ Ø£Ø¨Ùˆ ÙƒØªÙŠÙÙ‡", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹"},
        {d: "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡\n05 / 10 / 1447 Ù‡Ù€", n: "Ø£Ø­Ù…Ø¯ Ø¨Ù† Ù‚Ø§Ø¹ÙØ¯ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø¯Ø±Ù‡Ù… Ø§Ø¨ÙˆÙƒØªÙŠÙØ©", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ØµÙÙˆØ©\nØ§Ù„Ø±ÙŠØ§Ø¶"},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n14 / 10 / 1447 Ù‡Ù€", n: "Ø³Ø§Ù„Ù… Ø¨Ù† Ø·Ù„Ù‚ Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø¨Ù† Ø¨Ø¬Ø§Ø¯ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†\nØ§Ù„Ø±ÙŠØ§Ø¶"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n15 / 10 / 1447 Ù‡Ù€", n: "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø¨Ù† Ø¹Ù„ÙŠ Ø¨Ù† Ù…Ø²ÙŠØ¯ Ø¨Ù† ÙƒÙ„ÙŠØ¨ Ø¨Ù† Ø¹ÙˆØ± Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n22 / 10 / 1447 Ù‡Ù€", n: "ÙÙŠØµÙ„ Ø¨Ù† Ù†ÙˆØ§Ø± Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†ÙˆÙŠØµØ­ Ø¨Ù† Ù‡Ø¶Ù„Ø§ Ø§Ù„Ø´Ø¨ÙŠØ«Ø§Ù†ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø³ÙØ§Ø±Ø§Øª\nØ§Ù„Ø±ÙŠØ§Ø¶"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n14 / 11 / 1447 Ù‡Ù€", n: "ØªØ±ÙƒÙŠ Ø¨Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø³Ø¹ÙˆØ¯ Ø¨Ù† Ù…Ø«ÙŠØ¨ Ø¨Ù† ÙƒØ´Ù…ÙŠØ± Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹"},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n20 / 11 / 1447 Ù‡Ù€", n: "Ø¨Ø§Ù†ÙŠ Ø¨Ù† Ø¶ÙŠÙ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø¹Ø§ÙŠØ¶ Ø¨Ù† Ø­Ù…Ø¯ Ø§Ø¨ÙˆÙƒØªÙŠÙÙ‡", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹"},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n20 / 11 / 1447 Ù‡Ù€", n: "Ø±ÙŠØ§Ù† Ø¨Ù† Ù…Ø´Ø¹Ù„ Ø¨Ù† Ù…Ø³Ø­Ù„ Ø¨Ù† Ù…Ø´Ø¹Ù„ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø£ØµØ§ÙŠÙ„\nØ§Ù„Ø±ÙŠØ§Ø¶"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n21 / 11 / 1447 Ù‡Ù€", n: "Ø®Ø§Ù„Ø¯ Ø¨Ù† Ø´Ø¨ÙŠØ¨ Ø¨Ù† Ø¸Ø§ÙØ± Ø¨Ù† Ù…Ø²ÙŠØ¯ Ø¨Ù† ÙƒÙ„ÙŠØ¨ Ø¨Ù† Ø¹ÙˆØ± Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n28 / 11 / 1447 Ù‡Ù€", n: "Ù…Ø¨Ø§Ø±Ùƒ Ø¨Ù† Ù…Ø¯Ø±Ù‡Ù… Ø£Ø¨Ùˆ ÙƒØªÙŠÙÙ‡", h: "Ø¯ÙˆÙ„Ø© Ø§Ù„ÙƒÙˆÙŠØª"},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n24 / 01 / 1448 Ù‡Ù€", n: "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø±Ø²ÙˆÙ‚ Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ø¬Ø±", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©\nØ§Ù„Ø±ÙŠØ§Ø¶"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n10 / 02 / 1448 Ù‡Ù€", n: "Ø¹Ø§Ø¯Ù„ Ø¨Ù† Ø³Ù„ÙŠÙ…Ø§Ù† Ø¨Ù† Ù…Ù‚Ø¹Ø¯ Ø¨Ù† Ù…Ø°ÙƒØ± Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ÙØ®Ø§Ù…Ø©\nØ´Ù‚Ø±Ø§Ø¡"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n21 / 04 / 1448 Ù‡Ù€", n: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ± Ø¨Ù† ÙÙ„Ø§Ø­ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹"}
    ];

    function openModal(id) { document.getElementById(id).style.display = 'flex'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function showAppMsg(title, body) {
        document.getElementById('msgTitle').innerText = title;
        document.getElementById('msgBody').innerText = body;
        openModal('msgModal');
    }

    function openLoginModal() { 
        document.getElementById('adminPass').value = '';
        openModal('loginModal'); 
    }

    function doLogin() {
        if(document.getElementById('adminPass').value === "99511511") {
            isAdminActive = true;
            closeModal('loginModal');
            document.getElementById('adminArea').style.display = 'block';
            document.getElementById('loginBtn').style.display = 'none';
            drawTable();
            showAppMsg("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ", "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.");
        } else {
            showAppMsg("Ø®Ø·Ø£", "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.");
        }
    }

    function logout() { isAdminActive = false; location.reload(); }

    function drawTable() {
        const body = document.getElementById('mainTableBody');
        body.innerHTML = '';
        const list = JSON.parse(localStorage.getItem('mahaya_vFinal')) || tribalData;
        
        document.getElementById('adminHeader').style.display = isAdminActive ? 'table-cell' : 'none';

        list.forEach((item, i) => {
            body.innerHTML += `
                <tr>
                    <td class="col-date">${item.d}</td>
                    <td class="col-groom">${item.n}</td>
                    <td class="col-hall">${item.h}</td>
                    ${isAdminActive ? `<td>
                        <button onclick="openEditModal(${i})" style="color:#f39c12; border:none; background:none; cursor:pointer; font-size:1.2rem;">âœï¸</button>
                        <button onclick="askDel(${i})" style="color:#e74c3c; border:none; background:none; cursor:pointer; font-size:1.2rem; margin-right:10px;">ğŸ—‘ï¸</button>
                    </td>` : ''}
                </tr>
            `;
        });
    }

    function openEditModal(i = -1) {
        if(i === -1) {
            document.getElementById('modalTitle').innerText = "Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©";
            document.getElementById('editIdx').value = "-1";
            document.getElementById('inDate').value = "";
            document.getElementById('inName').value = "";
            document.getElementById('inHall').value = "";
        } else {
            const list = JSON.parse(localStorage.getItem('mahaya_vFinal')) || tribalData;
            document.getElementById('modalTitle').innerText = "ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†Ø§Ø³Ø¨Ø©";
            document.getElementById('editIdx').value = i;
            document.getElementById('inDate').value = list[i].d;
            document.getElementById('inName').value = list[i].n;
            document.getElementById('inHall').value = list[i].h;
        }
        openModal('eventModal');
    }

    function saveEvent() {
        const d = document.getElementById('inDate').value.trim();
        const n = document.getElementById('inName').value.trim();
        const h = document.getElementById('inHall').value.trim();
        const idx = parseInt(document.getElementById('editIdx').value);

        if(!d || !n || !h) { showAppMsg("ØªÙ†Ø¨ÙŠÙ‡", "ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© ÙƒØ§ÙØ© Ø§Ù„Ø­Ù‚ÙˆÙ„."); return; }

        let db = JSON.parse(localStorage.getItem('mahaya_vFinal')) || tribalData;
        if(idx === -1) db.push({d, n, h}); else db[idx] = {d, n, h};
        
        localStorage.setItem('mahaya_vFinal', JSON.stringify(db));
        closeModal('eventModal');
        drawTable();
    }

    function askDel(i) {
        document.getElementById('delIdx').value = i;
        openModal('confirmModal');
    }

    function doDelete() {
        const i = document.getElementById('delIdx').value;
        let db = JSON.parse(localStorage.getItem('mahaya_vFinal')) || tribalData;
        db.splice(i, 1);
        localStorage.setItem('mahaya_vFinal', JSON.stringify(db));
        closeModal('confirmModal');
        drawTable();
    }

    function searchTable() {
        let v = document.getElementById('searchInput').value.toUpperCase();
        let trs = document.getElementById('mainTableBody').getElementsByTagName('tr');
        for (let t of trs) {
            t.style.display = t.innerText.toUpperCase().includes(v) ? "" : "none";
        }
    }

    window.onload = drawTable;
</script>

</body>
</html>
