<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø£ÙØ±Ø§Ø­ Ø§Ù„Ù…Ø­Ø§ÙŠØ§ </title>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Kufi+Arabic:wght@400;600;800&family=Alexandria:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --gold: #d4a853;
            --gold-dark: #b8923a;
            --black: #000000;
            --modal-bg: #0a0a0a; 
            --input-bg: #111111;
            --white: #ffffff;
            --red: #ff4d4d;
            --overlay: rgba(0, 0, 0, 0.88);
            --radius-lg: 20px;
            --radius-pill: 50px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Noto Kufi Arabic', sans-serif;
            background-color: var(--black);
            background-image: linear-gradient(var(--overlay), var(--overlay)), url('422983.jpg');
            background-size: cover; background-position: center top; background-attachment: fixed;
            margin: 0; color: var(--white); line-height: 1.6; overflow-x: hidden; min-height: 100vh;
        }

        /* === Ø§Ù„Ø²Ø®Ø§Ø±Ù Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© === */
        .bg-pattern { position: fixed; inset: 0; pointer-events: none; z-index: 0; overflow: hidden; opacity: 0.6; }
        .bg-pattern::before {
            content: ''; position: absolute; top: -50%; right: -50%; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(212, 168, 83, 0.08) 0%, transparent 50%);
            animation: floatBg 20s ease-in-out infinite;
        }
        @keyframes floatBg { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(30px, 30px); } }

        .geometric-decoration { position: fixed; pointer-events: none; z-index: 0; }
        .geo-1 { top: 10%; left: 5%; width: 120px; height: 120px; border: 2px solid rgba(212, 168, 83, 0.1); transform: rotate(45deg); animation: pulse 4s ease-in-out infinite; }
        .geo-2 { bottom: 15%; right: 8%; width: 80px; height: 80px; background: linear-gradient(135deg, rgba(212, 168, 83, 0.05), transparent); border-radius: 50%; animation: pulse 5s ease-in-out infinite 1s; }
        
        @keyframes pulse { 0%, 100% { opacity: 0.3; transform: scale(1) rotate(45deg); } 50% { opacity: 0.7; transform: scale(1.1) rotate(45deg); } }

        .main-container { position: relative; z-index: 1; max-width: 1000px; margin: 0 auto; padding: 15px; }

        /* === Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø·ÙˆØ± (Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ÙˆØ§Ù„Ù†Ø¨Ø¶) === */
        header { text-align: center; padding: 40px 0; }
        .logo-wrapper { position: relative; width: 180px; height: 180px; margin: 0 auto 10px; }
        .logo-ring { position: absolute; inset: 25px; border: 3px solid transparent; border-top-color: var(--gold); border-radius: 50%; animation: logoSpin 4s linear infinite; z-index: 1; }
        .logo-ring:nth-child(2) { inset: 35px; border-top-color: var(--white); animation-direction: reverse; animation-duration: 6s; }
        
        .logo-icon { 
            position: absolute; inset: 30px; background: radial-gradient(circle, #222, #000); 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            box-shadow: 0 0 50px rgba(212, 168, 83, 0.4); overflow: visible;
        }
        .logo-icon img { 
            width: 175%; height: auto; 
            animation: pulseManuscript 3s ease-in-out infinite; 
            z-index: 10;
        }

        @keyframes pulseManuscript {
            0%, 100% { transform: scale(1.15); filter: drop-shadow(0 0 10px rgba(212,168,83,0.5)); }
            50% { transform: scale(1.25); filter: drop-shadow(0 0 25px rgba(212,168,83,0.8)); }
        }
        @keyframes logoSpin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        header h1 {
            font-family: 'Alexandria', sans-serif; font-size: 2rem;
            margin: 20px 0 0; background: linear-gradient(135deg, #fff, var(--gold));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .search-input { width: 100%; padding: 16px; background: rgba(255,255,255,0.07); border: 1px solid var(--gold); border-radius: 50px; color: white; text-align: center; margin-bottom: 25px; outline: none; backdrop-filter: blur(10px); font-family: 'Alexandria'; }

        .quote-box { background: rgba(212, 168, 83, 0.05); padding: 25px; border-radius: 20px; border: 1px dashed rgba(212,168,83,0.3); text-align: center; margin-bottom: 25px; backdrop-filter: blur(5px); }
        .quote-box p { font-family: 'Amiri'; font-size: 1.4rem; color: var(--gold); margin: 0; font-weight: 700; }

        .table-container { 
            width: 100%; background: rgba(0, 0, 0, 0.75); 
            border-radius: var(--radius-lg); border: 1px solid rgba(212, 168, 83, 0.2);
            box-shadow: 0 15px 40px rgba(0,0,0,0.8); overflow: hidden; backdrop-filter: blur(12px);
        }

        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        thead th { background: rgba(212, 168, 83, 0.2); color: var(--gold); padding: 20px 10px; font-family: 'Alexandria'; border-bottom: 2px solid var(--gold); }
        td { padding: 18px 10px; text-align: center; border-bottom: 1px solid rgba(212, 168, 83, 0.1); word-wrap: break-word; }

        .col-date-cell { width: 110px; }
        .day-label { color: var(--gold); font-weight: 800; font-size: 1rem; display: block; }
        .date-label { color: var(--white); font-size: 0.8rem; display: block; opacity: 0.7; }

        .info-cell { text-align: right; padding-right: 15px; }
        .groom-name { font-weight: 700; color: var(--white); font-size: 1.15rem; display: block; margin-bottom: 5px; }
        .hall-info { color: #aaa; font-size: 0.85rem; opacity: 0.9; }

        /* === Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³ÙˆØ¯ === */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.92); display: none; justify-content: center; align-items: center; z-index: 9999; backdrop-filter: blur(15px); padding: 15px; }
        
        .modal-card { 
            background: var(--modal-bg); 
            border: 1.5px solid var(--gold); 
            border-radius: 20px; 
            padding: 30px 20px; 
            width: 100%; 
            max-width: 420px; 
            text-align: center; 
        }
        
        .modal-card h3 { color: #fff; margin-bottom: 25px; font-family: 'Alexandria'; font-weight: 700; }

        /* ØµÙ Ø§Ù„ØªØ§Ø±ÙŠØ® (ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ…Ø¯Ø¯) */
        .date-inputs-row { display: flex; gap: 8px; margin-bottom: 15px; direction: rtl; }
        .date-inputs-row select, .date-inputs-row input { 
            background: var(--input-bg); border: 1px solid #222; border-radius: 10px; 
            color: white; padding: 12px 5px; text-align: center; outline: none; 
            flex: 1; font-size: 0.9rem; min-width: 0; 
        }
        #inDayName { flex: 2.5; } 

        .full-input { width: 100%; padding: 15px; margin-bottom: 15px; background: var(--input-bg); border: 1px solid #222; border-radius: 12px; color: white; text-align: center; outline: none; font-family: inherit; }

        .btn-row { display: flex; gap: 12px; margin-top: 20px; }
        .btn-pill { flex: 1; font-weight: 800; border-radius: 50px; padding: 15px; border: none; cursor: pointer; transition: 0.3s; font-size: 1rem; }
        .btn-save { background: var(--gold); color: #000; }
        .btn-cancel { background: #333333; color: #fff; }

        .admin-area { display: none; text-align: center; margin-top: 30px; }

        /* === Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù…Ø·ÙˆØ± === */
        footer { text-align: center; padding: 60px 15px; border-top: 1px solid rgba(212, 168, 83, 0.15); margin-top: 40px; background: rgba(0,0,0,0.5); }
        .blessing { font-family: 'Amiri', serif; font-size: 1.3rem; color: var(--gold); margin-bottom: 10px; font-weight: 700; white-space: nowrap; }
        .footer-title { font-family: 'Alexandria'; font-size: 1.3rem; color: #fff; font-weight: 700; margin-bottom: 10px; cursor: pointer; user-select: none; }
    </style>
</head>
<body>

<div class="bg-pattern"></div>
<div class="geometric-decoration geo-1"></div>
<div class="geometric-decoration geo-2"></div>

<div class="main-container">
    <header>
        <div class="logo-wrapper">
            <div class="logo-ring"></div>
            <div class="logo-ring"></div>
            <div class="logo-icon"><img src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø­Ø§ÙŠØ§"></div>
        </div>
        <h1>Ø£ÙØ±Ø§Ø­ Ù‚Ø¨ÙŠÙ„Ø© Ø§Ù„Ù…Ø­Ø§ÙŠØ§</h1>
    </header>

    <div class="quote-box">
        <p1>" ÙƒÙ„ Ù…Ù†Ø§Ø³Ø¨Ø© ØªÙØ¶Ø§Ù Ù‡Ù†Ø§ØŒ Ù‡ÙŠ ÙØ±Ø­Ø© ØªØ¬Ù…Ø¹ Ø´Ù…Ù„ Ø§Ù„Ù‚Ø¨ÙŠÙ„Ø© ÙˆØªÙˆØ«Ù‚ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙˆØ¯Ø© Ø¨ÙŠÙ† Ø£Ø¨Ù†Ø§Ø¦Ù‡Ø§ "</p1>
    </div>

    <input type="text" id="searchInput" onkeyup="searchEvents()" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù…ØŒ ØªØ§Ø±ÙŠØ®ØŒ Ø£Ùˆ Ù‚Ø§Ø¹Ø©...">

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th class="col-date-cell">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</th>
                    <th id="adminHeader" style="display:none;" width="100px">ØªØ­ÙƒÙ…</th>
                </tr>
            </thead>
            <tbody id="eventsTableBody"></tbody>
        </table>
    </div>

    <div id="adminArea" class="admin-area">
        <button class="btn-pill btn-save" style="max-width:260px;" onclick="openEventModal()">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© +</button>
        <button onclick="logout()" style="display:block; margin: 20px auto; background:none; border:none; color:var(--red); cursor:pointer; font-family:'Alexandria';">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>

    <footer>
        <div class="blessing">" Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù„Ù‡ Ù„Ù‡Ù…Ø§ ÙˆØ¨Ø§Ø±Ùƒ Ø¹Ù„ÙŠÙ‡Ù…Ø§ ÙˆØ¬Ù…Ø¹ Ø¨ÙŠÙ†Ù‡Ù…Ø§ Ø¨Ø®ÙŠØ± "</div>
        <div class="footer-title" id="secretTrigger">Ù…Ù†ØµØ© Ù‚Ø¨ÙŠÙ„Ø© Ø§Ù„Ù…Ø­Ø§ÙŠØ§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠØ©</div>
        <div style="color:var(--gold); margin-top:5px; font-weight: bold; font-size: 1.1rem;">Ø¨Ø±Ø¹Ø§ÙŠØ© Ø±Ø¬Ù„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ / Ø¹ÙŠØ¯ Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ù…Ø­ÙŠØ§Ù†ÙŠ</div>
    </footer>
</div>

<div id="loginModal" class="modal-overlay">
    <div class="modal-card">
        <h3>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
        <input type="password" id="adminPass" class="full-input" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <div class="btn-row">
            <button class="btn-pill btn-save" onclick="doLogin()">Ø¯Ø®ÙˆÙ„</button>
            <button class="btn-pill btn-cancel" onclick="closeModal('loginModal')">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>
</div>

<div id="eventModal" class="modal-overlay">
    <div class="modal-card">
        <h3 id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø©</h3>
        <input type="hidden" id="editIdx" value="-1">
        
        <div class="date-inputs-row">
            <select id="inDayName">
                <option value="">Ø§Ù„ÙŠÙˆÙ…</option>
                <option>Ø§Ù„Ø³Ø¨Øª</option><option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option>
                <option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option><option>Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
            </select>
            <input type="number" id="inDay" placeholder="ÙŠ">
            <input type="number" id="inMonth" placeholder="Ø´">
            <input type="number" id="inYear" placeholder="Ø³">
        </div>

        <input type="text" id="inName" class="full-input" placeholder="Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©">
        <input type="text" id="inHall" class="full-input" placeholder="Ø§Ù„Ù‚Ø§Ø¹Ø© ÙˆØ§Ù„Ù…Ø¯ÙŠÙ†Ø©">
        
        <select id="inCountry" class="full-input">
            <option value="">Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
            <option value="Ø§Ù„ÙƒÙˆÙŠØª">Ø¯ÙˆÙ„Ø© Ø§Ù„ÙƒÙˆÙŠØª ğŸ‡°ğŸ‡¼</option>
            <option value="Ù‚Ø·Ø±">Ø¯ÙˆÙ„Ø© Ù‚Ø·Ø± ğŸ‡¶ğŸ‡¦</option>
        </select>

        <div class="btn-row">
            <button class="btn-pill btn-save" onclick="saveEvent()">Ø­ÙØ¸</button>
            <button class="btn-pill btn-cancel" onclick="closeModal('eventModal')">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>
</div>

<div id="deleteConfirmModal" class="modal-overlay">
    <div class="modal-card" style="border-color: var(--red);">
        <h3 style="color: var(--red);">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h3>
        <p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ</p>
        <input type="hidden" id="deleteIdx">
        <div class="btn-row">
            <button class="btn-pill" style="background:var(--red); color:white;" onclick="confirmDelete()">Ø­Ø°Ù</button>
            <button class="btn-pill btn-cancel" onclick="closeModal('deleteConfirmModal')">ØªØ±Ø§Ø¬Ø¹</button>
        </div>
    </div>
</div>

<script>
    let isAdminActive = false;
    const dbKey = "mahaya_final_vFinal_Ultimate_v2";

    const initialData = [
        {d: "Ø§Ù„Ø³Ø¨Øª\n28 / 07 / 1447 Ù‡Ù€", n: "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø²ÙˆÙŠØ¯ Ø¨Ù† Ù…Ù†Ø§Ø­ÙŠ Ø¨Ù† Ù†Ø§ÙÙ„ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø¨Ø±ÙˆØ§Ø² - Ø§Ù„Ø¸Ù‡Ø±Ø§Ù†", c: ""},
        {d: "Ø§Ù„Ø£Ø­Ø¯\n03 / 10 / 1447 Ù‡Ù€", n: "Ø®Ø§Ù„Ø¯ Ø¨Ù† Ù‚Ø¹ÙŠØ¯ Ø¨Ù† Ù…Ù‚Ø¹Ø¯ Ø£Ø¨Ùˆ ÙƒØªÙŠÙÙ‡", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡\n05 / 10 / 1447 Ù‡Ù€", n: "Ø£Ø­Ù…Ø¯ Ø¨Ù† Ù‚Ø§Ø¹ÙØ¯ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø¯Ø±Ù‡Ù… Ø§Ø¨ÙˆÙƒØªÙŠÙØ©", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ØµÙÙˆØ© - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n14 / 10 / 1447 Ù‡Ù€", n: "Ø³Ø§Ù„Ù… Ø¨Ù† Ø·Ù„Ù‚ Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø¨Ù† Ø¨Ø¬Ø§Ø¯ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù† - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n15 / 10 / 1447 Ù‡Ù€", n: "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø¨Ù† Ø¹Ù„ÙŠ Ø¨Ù† Ù…Ø²ÙŠØ¯ Ø¨Ù† ÙƒÙ„ÙŠØ¨ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n22 / 10 / 1447 Ù‡Ù€", n: "ÙÙŠØµÙ„ Ø¨Ù† Ù†ÙˆØ§Ø± Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø´Ø¨ÙŠØ«Ø§Ù†ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø³ÙØ§Ø±Ø§Øª - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n14 / 11 / 1447 Ù‡Ù€", n: "ØªØ±ÙƒÙŠ Ø¨Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø³Ø¹ÙˆØ¯ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n20 / 11 / 1447 Ù‡Ù€", n: "Ø¨Ø§Ù†ÙŠ Ø¨Ù† Ø¶ÙŠÙ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø¹Ø§ÙŠØ¶ Ø§Ø¨ÙˆÙƒØªÙŠÙÙ‡", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n20 / 11 / 1447 Ù‡Ù€", n: "Ø±ÙŠØ§Ù† Ø¨Ù† Ù…Ø´Ø¹Ù„ Ø¨Ù† Ù…Ø³Ø­Ù„ Ø§Ù„Ø£ÙˆØ¨ÙŠØ¶", h: "Ù‚Ø§Ø¹Ø© Ø£ØµØ§ÙŠÙ„ - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n21 / 11 / 1447 Ù‡Ù€", n: "Ø®Ø§Ù„Ø¯ Ø¨Ù† Ø´Ø¨ÙŠØ¨ Ø¨Ù† Ø¸Ø§ÙØ± Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n28 / 11 / 1447 Ù‡Ù€", n: "Ù…Ø¨Ø§Ø±Ùƒ Ø¨Ù† Ù…Ø¯Ø±Ù‡Ù… Ø£Ø¨Ùˆ ÙƒØªÙŠÙÙ‡", h: "Ø¯ÙˆÙ„Ø© Ø§Ù„ÙƒÙˆÙŠØª", c: "Ø§Ù„ÙƒÙˆÙŠØª"},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n19 / 12 / 1447 Ù‡Ù€", n: "Ø¹Ù„ÙŠ Ø¨Ù† Ù…Ø·Ù„Ù‚ Ø¨Ù† Ø¹ÙˆØ¶ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ÙØ®Ø§Ù…Ø© - Ø´Ù‚Ø±Ø§Ø¡", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n24 / 01 / 1448 Ù‡Ù€", n: "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø±Ø²ÙˆÙ‚ Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ø¬Ø±", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø© - Ø§Ù„Ø±ÙŠØ§Ø¶", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n10 / 02 / 1448 Ù‡Ù€", n: "Ø¹Ø§Ø¯Ù„ Ø¨Ù† Ø³Ù„ÙŠÙ…Ø§Ù† Ø¨Ù† Ù…Ù‚Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "Ù‚Ø§Ø¹Ø© Ø§Ù„ÙØ®Ø§Ù…Ø© - Ø´Ù‚Ø±Ø§Ø¡", c: ""},
        {d: "Ø§Ù„Ø®Ù…ÙŠØ³\n21 / 03 / 1448 Ù‡Ù€", n: "Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ø¨ÙŠØ¯ Ø¨Ù† ÙƒÙ„ÙŠØ¨ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""},
        {d: "Ø§Ù„Ø¬Ù…Ø¹Ø©\n21 / 04 / 1448 Ù‡Ù€", n: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ± Ø¨Ù† ÙÙ„Ø§Ø­ Ø§Ù„Ù…Ø±Ø¬Ù„ÙŠ", h: "ÙŠØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹", c: ""}
    ];

    function sortHijri(list) {
        return list.sort((a, b) => {
            const getVal = (s) => {
                const m = s.match(/(\d{2})\s\/\s(\d{2})\s\/\s(\d{4})/);
                return m ? parseInt(m[3])*10000 + parseInt(m[2])*100 + parseInt(m[1]) : 0;
            };
            return getVal(a.d) - getVal(b.d);
        });
    }

    function drawEvents() {
        const tbody = document.getElementById('eventsTableBody'); tbody.innerHTML = '';
        let list = sortHijri(JSON.parse(localStorage.getItem(dbKey)) || initialData);
        document.getElementById('adminHeader').style.display = isAdminActive ? 'table-cell' : 'none';
        document.getElementById('adminArea').style.display = isAdminActive ? 'block' : 'none';
        list.forEach((item, i) => {
            const tr = document.createElement('tr');
            const p = item.d.split('\n');
            tr.innerHTML = `<td class="col-date-cell"><span class="day-label">${p[0]}</span><span class="date-label">${p[1]||''}</span></td>
                <td class="info-cell"><span class="groom-name">${item.n}</span><span class="hall-info ${item.c?'location-intl':''}">${item.c?'ğŸ‡°ğŸ‡¼ ':''}${item.h}</span></td>
                ${isAdminActive ? `<td><div style="display:flex; gap:5px; justify-content:center;">
                    <button style="background:none; border:none; color:var(--gold); cursor:pointer;" onclick="openEditModal(${i})"><i class="fa-solid fa-pen-to-square"></i></button>
                    <button style="background:none; border:none; color:var(--red); cursor:pointer;" onclick="askDelete(${i})"><i class="fa-solid fa-trash-can"></i></button>
                </div></td>` : ''}`;
            tbody.appendChild(tr);
        });
    }

    document.getElementById('secretTrigger').addEventListener('dblclick', () => {
        document.getElementById('adminPass').value = '';
        document.getElementById('loginModal').style.display = 'flex';
    });

    function doLogin() {
        if(document.getElementById('adminPass').value === "99511511") {
            isAdminActive = true; closeModal('loginModal'); drawEvents();
        } else { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©"); }
    }

    function saveEvent() {
        const day = document.getElementById('inDayName').value;
        const d = document.getElementById('inDay').value.toString().padStart(2, '0');
        const m = document.getElementById('inMonth').value.toString().padStart(2, '0');
        const y = document.getElementById('inYear').value;
        const n = document.getElementById('inName').value.trim();
        const h = document.getElementById('inHall').value.trim();
        const c = document.getElementById('inCountry').value;
        if(!day || !d || !m || !y || !n || !h) { alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!"); return; }
        const formattedDate = `${day}\n${d} / ${m} / ${y} Ù‡Ù€`;
        let list = JSON.parse(localStorage.getItem(dbKey)) || initialData;
        const idx = parseInt(document.getElementById('editIdx').value);
        if(idx === -1) list.push({d:formattedDate, n, h, c}); else list[idx] = {d:formattedDate, n, h, c};
        localStorage.setItem(dbKey, JSON.stringify(list));
        closeModal('eventModal'); drawEvents();
    }

    function openEditModal(i) {
        document.getElementById('eventModal').style.display = 'flex';
        document.getElementById('editIdx').value = i;
        const list = sortHijri(JSON.parse(localStorage.getItem(dbKey)) || initialData);
        const ev = list[i];
        
        document.getElementById('modalTitle').innerText = "ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†Ø§Ø³Ø¨Ø©";
        
        // ØªÙÙƒÙŠÙƒ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø¨Ø¦ØªÙ‡
        const parts = ev.d.split('\n');
        document.getElementById('inDayName').value = parts[0].trim();
        
        if (parts[1]) {
            const nums = parts[1].replace(' Ù‡Ù€', '').split(' / ');
            document.getElementById('inDay').value = parseInt(nums[0]);
            document.getElementById('inMonth').value = parseInt(nums[1]);
            document.getElementById('inYear').value = parseInt(nums[2]);
        }

        document.getElementById('inName').value = ev.n;
        document.getElementById('inHall').value = ev.h;
        document.getElementById('inCountry').value = ev.c || "";
    }

    function openEventModal() {
        document.getElementById('eventModal').style.display = 'flex';
        document.getElementById('editIdx').value = -1;
        document.getElementById('modalTitle').innerText = "Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ø³Ø¨Ø©";
        document.getElementById('inDayName').value = "";
        document.getElementById('inDay').value = "";
        document.getElementById('inMonth').value = "";
        document.getElementById('inYear').value = "";
        document.getElementById('inName').value = "";
        document.getElementById('inHall').value = "";
    }

    function askDelete(i) { document.getElementById('deleteIdx').value = i; document.getElementById('deleteConfirmModal').style.display='flex'; }
    function confirmDelete() {
        const i = document.getElementById('deleteIdx').value;
        let list = sortHijri(JSON.parse(localStorage.getItem(dbKey)) || initialData);
        list.splice(i, 1); localStorage.setItem(dbKey, JSON.stringify(list));
        closeModal('deleteConfirmModal'); drawEvents();
    }

    function logout() { isAdminActive = false; location.reload(); }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function searchEvents() {
        const v = document.getElementById('searchInput').value.toUpperCase();
        const rows = document.getElementById('eventsTableBody').getElementsByTagName('tr');
        for (let row of rows) { row.style.display = row.innerText.toUpperCase().includes(v) ? "" : "none"; }
    }
    window.onload = drawEvents;
</script>

</body>
</html>
